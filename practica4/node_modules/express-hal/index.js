var Resource = exports.Resource = require("./lib/Resource");

exports.middleware = function (req, res, next) {
    req.resource = res.resource = new Resource();

    res.hal = function (params) {
        if (params) {
            if (params.data)   res.resource.extend(params.data);
            if (params.links)  res.resource.links(params.links);
            if (params.embeds) res.resource.embeds(params.embeds);
            if (params.code)   res.statusCode = params.code;
        }

        res.json(res.resource);
    };

    return next();
};
